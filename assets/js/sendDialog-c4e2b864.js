import{a as U}from"./axios-aba6f0e0.js";import{g as p,b as g,a as v}from"./file-a5f5b941.js";import{k,e as y,$ as B,ah as b,o as c,c as r,W as h,Q as u,a as t,U as D,u as d,V as f,F as L,a9 as R,L as T}from"./@vue-d9027515.js";import{_ as A}from"./plugin-vueexport-helper-c27b6911.js";const I={class:"img-panel"},E={key:0},P=["src"],Q={class:"content"},W={class:"name"},$={class:"size"},j=["src"],q={class:"content"},G={class:"name"},H={class:"size"},J={class:"dialog-footer"},K=k({name:"sendDialog"}),M=k({...K,emits:["submitForm"],setup(O,{emit:N}){const m=y(!1),C=y("发送文件"),a=B({fileData:[]}),S=()=>{m.value=!1,a.fileData=[]},x=s=>{s(),a.fileData=[]},w=async()=>{const o="https://akram8.github.io/oginix-vite-demo/"+"/upload";let l=[];const i=[];for(const e of a.fileData){const n=new FormData;typeof e.fileSrc=="string"?n.append("file",z(e.fileSrc),e.fileName):n.append("file",e.fileSrc,e.fileName);const _=U.post(o,n,{}).then(V=>{l.push({id:"",name:e.fileName,type:p(e.fileName),typeColor:v(e.fileName),size:g(e.fileSize),fileId:V.data.data})});i.push(_)}return await Promise.all(i),l},F=async()=>{m.value=!1;const s=await w();await N("submitForm",s),a.fileData=[]},z=s=>{var _;const o=s.split(","),l=((_=o[0].match(/:(.*?);/))==null?void 0:_[1])||"",i=atob(o[1]);let e=i.length;const n=new Uint8Array(e);for(;e--;)n[e]=i.charCodeAt(e);return new Blob([n],{type:l})};return(s,o)=>{const l=b("el-button"),i=b("el-dialog");return c(),r("div",null,[h(i,{modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=e=>m.value=e),title:C.value,"close-on-click-modal":!1,"before-close":x,width:"420px"},{footer:u(()=>[t("span",J,[h(l,{onClick:S},{default:u(()=>[D("取消")]),_:1}),h(l,{type:"primary",onClick:F},{default:u(()=>[D(" 发送 ")]),_:1})])]),default:u(()=>[t("div",I,[a.fileData.length===1&&d(p)(a.fileData[0].fileName)==="image"?(c(),r("div",E,[t("img",{class:"img",src:a.fileData[0].fileSrc},null,8,P),t("div",Q,[t("div",W,f(a.fileData[0].fileName),1),t("div",$,f(d(g)(a.fileData[0].fileSize)),1)])])):(c(!0),r(L,{key:1},R(a.fileData,e=>(c(),r("div",{key:e.fileName,class:"item-list"},[d(p)(e.fileName)==="image"?(c(),r("img",{key:0,class:"img",src:e.fileSrc},null,8,j)):(c(),r("div",{key:1,class:"file-avatar",style:T({backgroundColor:d(v)(e.fileName)})},f(d(p)(e.fileName)),5)),t("div",q,[t("div",G,f(e.fileName),1),t("div",H,f(d(g)(e.fileSize)),1)])]))),128))])]),_:1},8,["modelValue","title"])])}}});const ae=A(M,[["__scopeId","data-v-564bde23"]]);export{ae as default};
